bev config Config (path: configs/nuscenes/det/transfusion/secfpn/camera+lidar/swint_v0p075/convfuser.yaml): {'seed': 0, 'deterministic': False, 'checkpoint_config': {'interval': 1, 'max_keep_ckpts': 1}, 'log_config': {'interval': 50, 'hooks': [{'type': 'TextLoggerHook'}, {'type': 'TensorboardLoggerHook'}]}, 'load_from': None, 'resume_from': None, 'cudnn_benchmark': False, 'fp16': {'loss_scale': {'growth_interval': 2000}}, 'max_epochs': 6, 'runner': {'type': 'CustomEpochBasedRunner', 'max_epochs': 6}, 'dataset_type': 'NuScenesDataset', 'dataset_root': 'data/nuscenes/', 'gt_paste_stop_epoch': -1, 'reduce_beams': 32, 'load_dim': 5, 'use_dim': 5, 'load_augmented': None, 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0], 'voxel_size': [0.075, 0.075, 0.2], 'image_size': [256, 704], 'augment2d': {'resize': [[0.38, 0.55], [0.48, 0.48]], 'rotate': [-5.4, 5.4], 'gridmask': {'prob': 0.0, 'fixed_prob': True}}, 'augment3d': {'scale': [0.9, 1.1], 'rotate': [-0.78539816, 0.78539816], 'translate': 0.5}, 'object_classes': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'map_classes': ['drivable_area', 'ped_crossing', 'walkway', 'stop_line', 'carpark_area', 'divider'], 'input_modality': {'use_lidar': True, 'use_camera': True, 'use_radar': False, 'use_map': False, 'use_external': False}, 'train_pipeline': [{'type': 'LoadMultiViewImageFromFiles', 'to_float32': True}, {'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 5, 'use_dim': 5, 'reduce_beams': 32, 'load_augmented': None}, {'type': 'LoadPointsFromMultiSweeps', 'sweeps_num': 9, 'load_dim': 5, 'use_dim': 5, 'reduce_beams': 32, 'pad_empty_sweeps': True, 'remove_close': True, 'load_augmented': None}, {'type': 'LoadAnnotations3D', 'with_bbox_3d': True, 'with_label_3d': True, 'with_attr_label': False}, {'type': 'ObjectPaste', 'stop_epoch': -1, 'db_sampler': {'dataset_root': 'data/nuscenes/', 'info_path': 'data/nuscenes/nuscenes_dbinfos_train.pkl', 'rate': 1.0, 'prepare': {'filter_by_difficulty': [-1], 'filter_by_min_points': {'car': 5, 'truck': 5, 'bus': 5, 'trailer': 5, 'construction_vehicle': 5, 'traffic_cone': 5, 'barrier': 5, 'motorcycle': 5, 'bicycle': 5, 'pedestrian': 5}}, 'classes': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'sample_groups': {'car': 2, 'truck': 3, 'construction_vehicle': 7, 'bus': 4, 'trailer': 6, 'barrier': 2, 'motorcycle': 6, 'bicycle': 6, 'pedestrian': 2, 'traffic_cone': 2}, 'points_loader': {'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 5, 'use_dim': 5, 'reduce_beams': 32}}}, {'type': 'ImageAug3D', 'final_dim': [256, 704], 'resize_lim': [0.38, 0.55], 'bot_pct_lim': [0.0, 0.0], 'rot_lim': [-5.4, 5.4], 'rand_flip': True, 'is_train': True}, {'type': 'GlobalRotScaleTrans', 'resize_lim': [0.9, 1.1], 'rot_lim': [-0.78539816, 0.78539816], 'trans_lim': 0.5, 'is_train': True}, {'type': 'LoadBEVSegmentation', 'dataset_root': 'data/nuscenes/', 'xbound': [-50.0, 50.0, 0.5], 'ybound': [-50.0, 50.0, 0.5], 'classes': ['drivable_area', 'ped_crossing', 'walkway', 'stop_line', 'carpark_area', 'divider']}, {'type': 'RandomFlip3D'}, {'type': 'PointsRangeFilter', 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0]}, {'type': 'ObjectRangeFilter', 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0]}, {'type': 'ObjectNameFilter', 'classes': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone']}, {'type': 'ImageNormalize', 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}, {'type': 'GridMask', 'use_h': True, 'use_w': True, 'max_epoch': 6, 'rotate': 1, 'offset': False, 'ratio': 0.5, 'mode': 1, 'prob': 0.0, 'fixed_prob': True}, {'type': 'PointShuffle'}, {'type': 'DefaultFormatBundle3D', 'classes': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone']}, {'type': 'Collect3D', 'keys': ['img', 'points', 'gt_bboxes_3d', 'gt_labels_3d', 'gt_masks_bev'], 'meta_keys': ['camera_intrinsics', 'camera2ego', 'lidar2ego', 'lidar2camera', 'camera2lidar', 'lidar2image', 'img_aug_matrix', 'lidar_aug_matrix']}], 'test_pipeline': [{'type': 'LoadMultiViewImageFromFiles', 'to_float32': True}, {'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 5, 'use_dim': 5, 'reduce_beams': 32, 'load_augmented': None}, {'type': 'LoadPointsFromMultiSweeps', 'sweeps_num': 9, 'load_dim': 5, 'use_dim': 5, 'reduce_beams': 32, 'pad_empty_sweeps': True, 'remove_close': True, 'load_augmented': None}, {'type': 'LoadAnnotations3D', 'with_bbox_3d': True, 'with_label_3d': True, 'with_attr_label': False}, {'type': 'ImageAug3D', 'final_dim': [256, 704], 'resize_lim': [0.48, 0.48], 'bot_pct_lim': [0.0, 0.0], 'rot_lim': [0.0, 0.0], 'rand_flip': False, 'is_train': False}, {'type': 'GlobalRotScaleTrans', 'resize_lim': [1.0, 1.0], 'rot_lim': [0.0, 0.0], 'trans_lim': 0.0, 'is_train': False}, {'type': 'LoadBEVSegmentation', 'dataset_root': 'data/nuscenes/', 'xbound': [-50.0, 50.0, 0.5], 'ybound': [-50.0, 50.0, 0.5], 'classes': ['drivable_area', 'ped_crossing', 'walkway', 'stop_line', 'carpark_area', 'divider']}, {'type': 'PointsRangeFilter', 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0]}, {'type': 'ImageNormalize', 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}, {'type': 'DefaultFormatBundle3D', 'classes': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone']}, {'type': 'Collect3D', 'keys': ['img', 'points', 'gt_bboxes_3d', 'gt_labels_3d', 'gt_masks_bev'], 'meta_keys': ['camera_intrinsics', 'camera2ego', 'lidar2ego', 'lidar2camera', 'camera2lidar', 'lidar2image', 'img_aug_matrix', 'lidar_aug_matrix']}], 'data': {'samples_per_gpu': 4, 'workers_per_gpu': 4, 'train': {'type': 'CBGSDataset', 'dataset': {'type': 'NuScenesDataset', 'dataset_root': 'data/nuscenes/', 'ann_file': 'data/nuscenes/nuscenes_12hz_infos_train.pkl', 'pipeline': [{'type': 'LoadMultiViewImageFromFiles', 'to_float32': True}, {'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 5, 'use_dim': 5, 'reduce_beams': 32, 'load_augmented': None}, {'type': 'LoadPointsFromMultiSweeps', 'sweeps_num': 9, 'load_dim': 5, 'use_dim': 5, 'reduce_beams': 32, 'pad_empty_sweeps': True, 'remove_close': True, 'load_augmented': None}, {'type': 'LoadAnnotations3D', 'with_bbox_3d': True, 'with_label_3d': True, 'with_attr_label': False}, {'type': 'ObjectPaste', 'stop_epoch': -1, 'db_sampler': {'dataset_root': 'data/nuscenes/', 'info_path': 'data/nuscenes/nuscenes_dbinfos_train.pkl', 'rate': 1.0, 'prepare': {'filter_by_difficulty': [-1], 'filter_by_min_points': {'car': 5, 'truck': 5, 'bus': 5, 'trailer': 5, 'construction_vehicle': 5, 'traffic_cone': 5, 'barrier': 5, 'motorcycle': 5, 'bicycle': 5, 'pedestrian': 5}}, 'classes': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'sample_groups': {'car': 2, 'truck': 3, 'construction_vehicle': 7, 'bus': 4, 'trailer': 6, 'barrier': 2, 'motorcycle': 6, 'bicycle': 6, 'pedestrian': 2, 'traffic_cone': 2}, 'points_loader': {'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 5, 'use_dim': 5, 'reduce_beams': 32}}}, {'type': 'ImageAug3D', 'final_dim': [256, 704], 'resize_lim': [0.38, 0.55], 'bot_pct_lim': [0.0, 0.0], 'rot_lim': [-5.4, 5.4], 'rand_flip': True, 'is_train': True}, {'type': 'GlobalRotScaleTrans', 'resize_lim': [0.9, 1.1], 'rot_lim': [-0.78539816, 0.78539816], 'trans_lim': 0.5, 'is_train': True}, {'type': 'LoadBEVSegmentation', 'dataset_root': 'data/nuscenes/', 'xbound': [-50.0, 50.0, 0.5], 'ybound': [-50.0, 50.0, 0.5], 'classes': ['drivable_area', 'ped_crossing', 'walkway', 'stop_line', 'carpark_area', 'divider']}, {'type': 'RandomFlip3D'}, {'type': 'PointsRangeFilter', 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0]}, {'type': 'ObjectRangeFilter', 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0]}, {'type': 'ObjectNameFilter', 'classes': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone']}, {'type': 'ImageNormalize', 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}, {'type': 'GridMask', 'use_h': True, 'use_w': True, 'max_epoch': 6, 'rotate': 1, 'offset': False, 'ratio': 0.5, 'mode': 1, 'prob': 0.0, 'fixed_prob': True}, {'type': 'PointShuffle'}, {'type': 'DefaultFormatBundle3D', 'classes': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone']}, {'type': 'Collect3D', 'keys': ['img', 'points', 'gt_bboxes_3d', 'gt_labels_3d', 'gt_masks_bev'], 'meta_keys': ['camera_intrinsics', 'camera2ego', 'lidar2ego', 'lidar2camera', 'camera2lidar', 'lidar2image', 'img_aug_matrix', 'lidar_aug_matrix']}], 'object_classes': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'map_classes': ['drivable_area', 'ped_crossing', 'walkway', 'stop_line', 'carpark_area', 'divider'], 'modality': {'use_lidar': True, 'use_camera': True, 'use_radar': False, 'use_map': False, 'use_external': False}, 'test_mode': False, 'use_valid_flag': True, 'box_type_3d': 'LiDAR'}}, 'val': {'type': 'NuScenesDataset', 'dataset_root': 'data/nuscenes/', 'ann_file': 'data/nuscenes/nuscenes_12hz_infos_val.pkl', 'pipeline': [{'type': 'LoadMultiViewImageFromFiles', 'to_float32': True}, {'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 5, 'use_dim': 5, 'reduce_beams': 32, 'load_augmented': None}, {'type': 'LoadPointsFromMultiSweeps', 'sweeps_num': 9, 'load_dim': 5, 'use_dim': 5, 'reduce_beams': 32, 'pad_empty_sweeps': True, 'remove_close': True, 'load_augmented': None}, {'type': 'LoadAnnotations3D', 'with_bbox_3d': True, 'with_label_3d': True, 'with_attr_label': False}, {'type': 'ImageAug3D', 'final_dim': [256, 704], 'resize_lim': [0.48, 0.48], 'bot_pct_lim': [0.0, 0.0], 'rot_lim': [0.0, 0.0], 'rand_flip': False, 'is_train': False}, {'type': 'GlobalRotScaleTrans', 'resize_lim': [1.0, 1.0], 'rot_lim': [0.0, 0.0], 'trans_lim': 0.0, 'is_train': False}, {'type': 'LoadBEVSegmentation', 'dataset_root': 'data/nuscenes/', 'xbound': [-50.0, 50.0, 0.5], 'ybound': [-50.0, 50.0, 0.5], 'classes': ['drivable_area', 'ped_crossing', 'walkway', 'stop_line', 'carpark_area', 'divider']}, {'type': 'PointsRangeFilter', 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0]}, {'type': 'ImageNormalize', 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}, {'type': 'DefaultFormatBundle3D', 'classes': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone']}, {'type': 'Collect3D', 'keys': ['img', 'points', 'gt_bboxes_3d', 'gt_labels_3d', 'gt_masks_bev'], 'meta_keys': ['camera_intrinsics', 'camera2ego', 'lidar2ego', 'lidar2camera', 'camera2lidar', 'lidar2image', 'img_aug_matrix', 'lidar_aug_matrix']}], 'object_classes': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'map_classes': ['drivable_area', 'ped_crossing', 'walkway', 'stop_line', 'carpark_area', 'divider'], 'modality': {'use_lidar': True, 'use_camera': True, 'use_radar': False, 'use_map': False, 'use_external': False}, 'test_mode': False, 'box_type_3d': 'LiDAR'}, 'test': {'type': 'NuScenesDataset', 'dataset_root': 'data/nuscenes/', 'ann_file': 'data/nuscenes/nuscenes_12hz_infos_val.pkl', 'pipeline': [{'type': 'LoadMultiViewImageFromFiles', 'to_float32': True}, {'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 5, 'use_dim': 5, 'reduce_beams': 32, 'load_augmented': None}, {'type': 'LoadPointsFromMultiSweeps', 'sweeps_num': 9, 'load_dim': 5, 'use_dim': 5, 'reduce_beams': 32, 'pad_empty_sweeps': True, 'remove_close': True, 'load_augmented': None}, {'type': 'LoadAnnotations3D', 'with_bbox_3d': True, 'with_label_3d': True, 'with_attr_label': False}, {'type': 'ImageAug3D', 'final_dim': [256, 704], 'resize_lim': [0.48, 0.48], 'bot_pct_lim': [0.0, 0.0], 'rot_lim': [0.0, 0.0], 'rand_flip': False, 'is_train': False}, {'type': 'GlobalRotScaleTrans', 'resize_lim': [1.0, 1.0], 'rot_lim': [0.0, 0.0], 'trans_lim': 0.0, 'is_train': False}, {'type': 'LoadBEVSegmentation', 'dataset_root': 'data/nuscenes/', 'xbound': [-50.0, 50.0, 0.5], 'ybound': [-50.0, 50.0, 0.5], 'classes': ['drivable_area', 'ped_crossing', 'walkway', 'stop_line', 'carpark_area', 'divider']}, {'type': 'PointsRangeFilter', 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0]}, {'type': 'ImageNormalize', 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}, {'type': 'DefaultFormatBundle3D', 'classes': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone']}, {'type': 'Collect3D', 'keys': ['img', 'points', 'gt_bboxes_3d', 'gt_labels_3d', 'gt_masks_bev'], 'meta_keys': ['camera_intrinsics', 'camera2ego', 'lidar2ego', 'lidar2camera', 'camera2lidar', 'lidar2image', 'img_aug_matrix', 'lidar_aug_matrix']}], 'object_classes': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'map_classes': ['drivable_area', 'ped_crossing', 'walkway', 'stop_line', 'carpark_area', 'divider'], 'modality': {'use_lidar': True, 'use_camera': True, 'use_radar': False, 'use_map': False, 'use_external': False}, 'test_mode': True, 'box_type_3d': 'LiDAR'}}, 'evaluation': {'interval': 1, 'pipeline': [{'type': 'LoadMultiViewImageFromFiles', 'to_float32': True}, {'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 5, 'use_dim': 5, 'reduce_beams': 32, 'load_augmented': None}, {'type': 'LoadPointsFromMultiSweeps', 'sweeps_num': 9, 'load_dim': 5, 'use_dim': 5, 'reduce_beams': 32, 'pad_empty_sweeps': True, 'remove_close': True, 'load_augmented': None}, {'type': 'LoadAnnotations3D', 'with_bbox_3d': True, 'with_label_3d': True, 'with_attr_label': False}, {'type': 'ImageAug3D', 'final_dim': [256, 704], 'resize_lim': [0.48, 0.48], 'bot_pct_lim': [0.0, 0.0], 'rot_lim': [0.0, 0.0], 'rand_flip': False, 'is_train': False}, {'type': 'GlobalRotScaleTrans', 'resize_lim': [1.0, 1.0], 'rot_lim': [0.0, 0.0], 'trans_lim': 0.0, 'is_train': False}, {'type': 'LoadBEVSegmentation', 'dataset_root': 'data/nuscenes/', 'xbound': [-50.0, 50.0, 0.5], 'ybound': [-50.0, 50.0, 0.5], 'classes': ['drivable_area', 'ped_crossing', 'walkway', 'stop_line', 'carpark_area', 'divider']}, {'type': 'PointsRangeFilter', 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0]}, {'type': 'ImageNormalize', 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}, {'type': 'DefaultFormatBundle3D', 'classes': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone']}, {'type': 'Collect3D', 'keys': ['img', 'points', 'gt_bboxes_3d', 'gt_labels_3d', 'gt_masks_bev'], 'meta_keys': ['camera_intrinsics', 'camera2ego', 'lidar2ego', 'lidar2camera', 'camera2lidar', 'lidar2image', 'img_aug_matrix', 'lidar_aug_matrix']}]}, 'model': {'type': 'BEVFusion', 'encoders': {'camera': {'neck': {'type': 'GeneralizedLSSFPN', 'in_channels': [192, 384, 768], 'out_channels': 256, 'start_level': 0, 'num_outs': 3, 'norm_cfg': {'type': 'BN2d', 'requires_grad': True}, 'act_cfg': {'type': 'ReLU', 'inplace': True}, 'upsample_cfg': {'mode': 'bilinear', 'align_corners': False}}, 'vtransform': {'type': 'DepthLSSTransform', 'in_channels': 256, 'out_channels': 80, 'image_size': [256, 704], 'feature_size': [32, 88], 'xbound': [-54.0, 54.0, 0.3], 'ybound': [-54.0, 54.0, 0.3], 'zbound': [-10.0, 10.0, 20.0], 'dbound': [1.0, 60.0, 0.5], 'downsample': 2}, 'backbone': {'type': 'SwinTransformer', 'embed_dims': 96, 'depths': [2, 2, 6, 2], 'num_heads': [3, 6, 12, 24], 'window_size': 7, 'mlp_ratio': 4, 'qkv_bias': True, 'qk_scale': None, 'drop_rate': 0.0, 'attn_drop_rate': 0.0, 'drop_path_rate': 0.2, 'patch_norm': True, 'out_indices': [1, 2, 3], 'with_cp': False, 'convert_weights': True, 'init_cfg': {'type': 'Pretrained', 'checkpoint': 'pretrained/swint-nuimages-pretrained.pth'}}}, 'lidar': {'voxelize': {'max_num_points': 10, 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0], 'voxel_size': [0.075, 0.075, 0.2], 'max_voxels': [120000, 160000]}, 'backbone': {'type': 'SparseEncoder', 'in_channels': 5, 'sparse_shape': [41, 1600, 1408], 'output_channels': 128, 'order': ['conv', 'norm', 'act'], 'encoder_channels': [[16, 16, 32], [32, 32, 64], [64, 64, 128], [128, 128]], 'encoder_paddings': [[0, 0, 1], [0, 0, 1], [0, 0, [1, 1, 0]], [0, 0]], 'block_type': 'basicblock'}}}, 'fuser': {'type': 'ConvFuser', 'in_channels': [80, 256], 'out_channels': 256}, 'heads': {'map': None, 'object': {'type': 'TransFusionHead', 'num_proposals': 200, 'auxiliary': True, 'in_channels': 512, 'hidden_channel': 128, 'num_classes': 10, 'num_decoder_layers': 1, 'num_heads': 8, 'nms_kernel_size': 3, 'ffn_channel': 256, 'dropout': 0.1, 'bn_momentum': 0.1, 'activation': 'relu', 'train_cfg': {'dataset': 'nuScenes', 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0], 'grid_size': [1440, 1440, 41], 'voxel_size': [0.075, 0.075, 0.2], 'out_size_factor': 8, 'gaussian_overlap': 0.1, 'min_radius': 2, 'pos_weight': -1, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2], 'assigner': {'type': 'HungarianAssigner3D', 'iou_calculator': {'type': 'BboxOverlaps3D', 'coordinate': 'lidar'}, 'cls_cost': {'type': 'FocalLossCost', 'gamma': 2.0, 'alpha': 0.25, 'weight': 0.15}, 'reg_cost': {'type': 'BBoxBEVL1Cost', 'weight': 0.25}, 'iou_cost': {'type': 'IoU3DCost', 'weight': 0.25}}}, 'test_cfg': {'dataset': 'nuScenes', 'grid_size': [1440, 1440, 41], 'out_size_factor': 8, 'voxel_size': [0.075, 0.075], 'pc_range': [-54.0, -54.0], 'nms_type': None}, 'common_heads': {'center': [2, 2], 'height': [1, 2], 'dim': [3, 2], 'rot': [2, 2], 'vel': [2, 2]}, 'bbox_coder': {'type': 'TransFusionBBoxCoder', 'pc_range': [-54.0, -54.0], 'post_center_range': [-61.2, -61.2, -10.0, 61.2, 61.2, 10.0], 'score_threshold': 0.0, 'out_size_factor': 8, 'voxel_size': [0.075, 0.075], 'code_size': 10}, 'loss_cls': {'type': 'FocalLoss', 'use_sigmoid': True, 'gamma': 2.0, 'alpha': 0.25, 'reduction': 'mean', 'loss_weight': 1.0}, 'loss_heatmap': {'type': 'GaussianFocalLoss', 'reduction': 'mean', 'loss_weight': 1.0}, 'loss_bbox': {'type': 'L1Loss', 'reduction': 'mean', 'loss_weight': 0.25}}}, 'decoder': {'backbone': {'type': 'SECOND', 'in_channels': 256, 'out_channels': [128, 256], 'layer_nums': [5, 5], 'layer_strides': [1, 2], 'norm_cfg': {'type': 'BN', 'eps': 0.001, 'momentum': 0.01}, 'conv_cfg': {'type': 'Conv2d', 'bias': False}}, 'neck': {'type': 'SECONDFPN', 'in_channels': [128, 256], 'out_channels': [256, 256], 'upsample_strides': [1, 2], 'norm_cfg': {'type': 'BN', 'eps': 0.001, 'momentum': 0.01}, 'upsample_cfg': {'type': 'deconv', 'bias': False}, 'use_conv_for_no_stride': True}}}, 'optimizer': {'type': 'AdamW', 'lr': 0.0002, 'weight_decay': 0.01}, 'optimizer_config': {'grad_clip': {'max_norm': 35, 'norm_type': 2}}, 'lr_config': {'policy': 'CosineAnnealing', 'warmup': 'linear', 'warmup_iters': 500, 'warmup_ratio': 0.33333333, 'min_lr_ratio': 0.001}, 'momentum_config': {'policy': 'cyclic'}, 'config': './configs/vic3d/late-fusion-image-pointcloud/bevfusion/trainval_config_i_v1.py'}
cfg.model1 {'type': 'BEVFusion', 'encoders': {'camera': {'neck': {'type': 'GeneralizedLSSFPN', 'in_channels': [192, 384, 768], 'out_channels': 256, 'start_level': 0, 'num_outs': 3, 'norm_cfg': {'type': 'BN2d', 'requires_grad': True}, 'act_cfg': {'type': 'ReLU', 'inplace': True}, 'upsample_cfg': {'mode': 'bilinear', 'align_corners': False}}, 'vtransform': {'type': 'DepthLSSTransform', 'in_channels': 256, 'out_channels': 80, 'image_size': [256, 704], 'feature_size': [32, 88], 'xbound': [-54.0, 54.0, 0.3], 'ybound': [-54.0, 54.0, 0.3], 'zbound': [-10.0, 10.0, 20.0], 'dbound': [1.0, 60.0, 0.5], 'downsample': 2}, 'backbone': {'type': 'SwinTransformer', 'embed_dims': 96, 'depths': [2, 2, 6, 2], 'num_heads': [3, 6, 12, 24], 'window_size': 7, 'mlp_ratio': 4, 'qkv_bias': True, 'qk_scale': None, 'drop_rate': 0.0, 'attn_drop_rate': 0.0, 'drop_path_rate': 0.2, 'patch_norm': True, 'out_indices': [1, 2, 3], 'with_cp': False, 'convert_weights': True, 'init_cfg': {'type': 'Pretrained', 'checkpoint': 'pretrained/swint-nuimages-pretrained.pth'}}}, 'lidar': {'voxelize': {'max_num_points': 10, 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0], 'voxel_size': [0.075, 0.075, 0.2], 'max_voxels': [120000, 160000]}, 'backbone': {'type': 'SparseEncoder', 'in_channels': 5, 'sparse_shape': [41, 1600, 1408], 'output_channels': 128, 'order': ['conv', 'norm', 'act'], 'encoder_channels': [[16, 16, 32], [32, 32, 64], [64, 64, 128], [128, 128]], 'encoder_paddings': [[0, 0, 1], [0, 0, 1], [0, 0, [1, 1, 0]], [0, 0]], 'block_type': 'basicblock'}}}, 'fuser': {'type': 'ConvFuser', 'in_channels': [80, 256], 'out_channels': 256}, 'heads': {'map': None, 'object': {'type': 'TransFusionHead', 'num_proposals': 200, 'auxiliary': True, 'in_channels': 512, 'hidden_channel': 128, 'num_classes': 10, 'num_decoder_layers': 1, 'num_heads': 8, 'nms_kernel_size': 3, 'ffn_channel': 256, 'dropout': 0.1, 'bn_momentum': 0.1, 'activation': 'relu', 'train_cfg': {'dataset': 'nuScenes', 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0], 'grid_size': [1440, 1440, 41], 'voxel_size': [0.075, 0.075, 0.2], 'out_size_factor': 8, 'gaussian_overlap': 0.1, 'min_radius': 2, 'pos_weight': -1, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2], 'assigner': {'type': 'HungarianAssigner3D', 'iou_calculator': {'type': 'BboxOverlaps3D', 'coordinate': 'lidar'}, 'cls_cost': {'type': 'FocalLossCost', 'gamma': 2.0, 'alpha': 0.25, 'weight': 0.15}, 'reg_cost': {'type': 'BBoxBEVL1Cost', 'weight': 0.25}, 'iou_cost': {'type': 'IoU3DCost', 'weight': 0.25}}}, 'test_cfg': {'dataset': 'nuScenes', 'grid_size': [1440, 1440, 41], 'out_size_factor': 8, 'voxel_size': [0.075, 0.075], 'pc_range': [-54.0, -54.0], 'nms_type': None}, 'common_heads': {'center': [2, 2], 'height': [1, 2], 'dim': [3, 2], 'rot': [2, 2], 'vel': [2, 2]}, 'bbox_coder': {'type': 'TransFusionBBoxCoder', 'pc_range': [-54.0, -54.0], 'post_center_range': [-61.2, -61.2, -10.0, 61.2, 61.2, 10.0], 'score_threshold': 0.0, 'out_size_factor': 8, 'voxel_size': [0.075, 0.075], 'code_size': 10}, 'loss_cls': {'type': 'FocalLoss', 'use_sigmoid': True, 'gamma': 2.0, 'alpha': 0.25, 'reduction': 'mean', 'loss_weight': 1.0}, 'loss_heatmap': {'type': 'GaussianFocalLoss', 'reduction': 'mean', 'loss_weight': 1.0}, 'loss_bbox': {'type': 'L1Loss', 'reduction': 'mean', 'loss_weight': 0.25}}}, 'decoder': {'backbone': {'type': 'SECOND', 'in_channels': 256, 'out_channels': [128, 256], 'layer_nums': [5, 5], 'layer_strides': [1, 2], 'norm_cfg': {'type': 'BN', 'eps': 0.001, 'momentum': 0.01}, 'conv_cfg': {'type': 'Conv2d', 'bias': False}}, 'neck': {'type': 'SECONDFPN', 'in_channels': [128, 256], 'out_channels': [256, 256], 'upsample_strides': [1, 2], 'norm_cfg': {'type': 'BN', 'eps': 0.001, 'momentum': 0.01}, 'upsample_cfg': {'type': 'deconv', 'bias': False}, 'use_conv_for_no_stride': True}}}
load_model finish
cfg.model2 {'type': 'BEVFusion', 'encoders': {'camera': {'neck': {'type': 'GeneralizedLSSFPN', 'in_channels': [192, 384, 768], 'out_channels': 256, 'start_level': 0, 'num_outs': 3, 'norm_cfg': {'type': 'BN2d', 'requires_grad': True}, 'act_cfg': {'type': 'ReLU', 'inplace': True}, 'upsample_cfg': {'mode': 'bilinear', 'align_corners': False}}, 'vtransform': {'type': 'DepthLSSTransform', 'in_channels': 256, 'out_channels': 80, 'image_size': [256, 704], 'feature_size': [32, 88], 'xbound': [-54.0, 54.0, 0.3], 'ybound': [-54.0, 54.0, 0.3], 'zbound': [-10.0, 10.0, 20.0], 'dbound': [1.0, 60.0, 0.5], 'downsample': 2}, 'backbone': {'type': 'SwinTransformer', 'embed_dims': 96, 'depths': [2, 2, 6, 2], 'num_heads': [3, 6, 12, 24], 'window_size': 7, 'mlp_ratio': 4, 'qkv_bias': True, 'qk_scale': None, 'drop_rate': 0.0, 'attn_drop_rate': 0.0, 'drop_path_rate': 0.2, 'patch_norm': True, 'out_indices': [1, 2, 3], 'with_cp': False, 'convert_weights': True, 'init_cfg': {'type': 'Pretrained', 'checkpoint': 'pretrained/swint-nuimages-pretrained.pth'}}}, 'lidar': {'voxelize': {'max_num_points': 10, 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0], 'voxel_size': [0.075, 0.075, 0.2], 'max_voxels': [120000, 160000]}, 'backbone': {'type': 'SparseEncoder', 'in_channels': 5, 'sparse_shape': [41, 1600, 1408], 'output_channels': 128, 'order': ['conv', 'norm', 'act'], 'encoder_channels': [[16, 16, 32], [32, 32, 64], [64, 64, 128], [128, 128]], 'encoder_paddings': [[0, 0, 1], [0, 0, 1], [0, 0, [1, 1, 0]], [0, 0]], 'block_type': 'basicblock'}}}, 'fuser': {'type': 'ConvFuser', 'in_channels': [80, 256], 'out_channels': 256}, 'heads': {'map': None, 'object': {'type': 'TransFusionHead', 'num_proposals': 200, 'auxiliary': True, 'in_channels': 512, 'hidden_channel': 128, 'num_classes': 10, 'num_decoder_layers': 1, 'num_heads': 8, 'nms_kernel_size': 3, 'ffn_channel': 256, 'dropout': 0.1, 'bn_momentum': 0.1, 'activation': 'relu', 'train_cfg': {'dataset': 'nuScenes', 'point_cloud_range': [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0], 'grid_size': [1440, 1440, 41], 'voxel_size': [0.075, 0.075, 0.2], 'out_size_factor': 8, 'gaussian_overlap': 0.1, 'min_radius': 2, 'pos_weight': -1, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2], 'assigner': {'type': 'HungarianAssigner3D', 'iou_calculator': {'type': 'BboxOverlaps3D', 'coordinate': 'lidar'}, 'cls_cost': {'type': 'FocalLossCost', 'gamma': 2.0, 'alpha': 0.25, 'weight': 0.15}, 'reg_cost': {'type': 'BBoxBEVL1Cost', 'weight': 0.25}, 'iou_cost': {'type': 'IoU3DCost', 'weight': 0.25}}}, 'test_cfg': {'dataset': 'nuScenes', 'grid_size': [1440, 1440, 41], 'out_size_factor': 8, 'voxel_size': [0.075, 0.075], 'pc_range': [-54.0, -54.0], 'nms_type': None}, 'common_heads': {'center': [2, 2], 'height': [1, 2], 'dim': [3, 2], 'rot': [2, 2], 'vel': [2, 2]}, 'bbox_coder': {'type': 'TransFusionBBoxCoder', 'pc_range': [-54.0, -54.0], 'post_center_range': [-61.2, -61.2, -10.0, 61.2, 61.2, 10.0], 'score_threshold': 0.0, 'out_size_factor': 8, 'voxel_size': [0.075, 0.075], 'code_size': 10}, 'loss_cls': {'type': 'FocalLoss', 'use_sigmoid': True, 'gamma': 2.0, 'alpha': 0.25, 'reduction': 'mean', 'loss_weight': 1.0}, 'loss_heatmap': {'type': 'GaussianFocalLoss', 'reduction': 'mean', 'loss_weight': 1.0}, 'loss_bbox': {'type': 'L1Loss', 'reduction': 'mean', 'loss_weight': 0.25}}}, 'decoder': {'backbone': {'type': 'SECOND', 'in_channels': 256, 'out_channels': [128, 256], 'layer_nums': [5, 5], 'layer_strides': [1, 2], 'norm_cfg': {'type': 'BN', 'eps': 0.001, 'momentum': 0.01}, 'conv_cfg': {'type': 'Conv2d', 'bias': False}}, 'neck': {'type': 'SECONDFPN', 'in_channels': [128, 256], 'out_channels': [256, 256], 'upsample_strides': [1, 2], 'norm_cfg': {'type': 'BN', 'eps': 0.001, 'momentum': 0.01}, 'upsample_cfg': {'type': 'deconv', 'bias': False}, 'use_conv_for_no_stride': True}}}
a=b True
load_ext
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/005346.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/005346.json
load_json {'rotation': [[-0.8630718377927395, 0.5050786556976403, -0.001731836450429378], [-0.5050813037532653, -0.86306321863828, 0.003920445754716041], [0.00048547770427869857, 0.004258352131573435, 0.9999912838759052]], 'translation': [[2733.2062150225393], [1694.932116930373], [21.46215066430601]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[0.10110970060354674, -1.000711521547571, 0.011220729934179371], [-0.2107882792537585, -0.02776873858533773, -0.7986380231662247], [0.9730329919664971, 0.08789024621230597, -0.1750508608779963]], 'translation': [[-2.473586406852653], [5.591948549790895], [1.3769298336996387]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/015810.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/015810.json
load_json {'rotation': [[0.5154831044564933, 0.8568992812149886, 0.00031747724543475876], [-0.856855962581391, 0.5154530215766044, 0.01027377178861629], [0.008639952245136955, -0.005567987176849824, 0.9999476200547389]], 'translation': [[3663.217251131602], [2323.914483487606], [20.222843317727893]], 'relative_error': {'delta_x': 0.5800000000000001, 'delta_y': -1.1}}
load_json {'rotation': [[-0.0018792800791834483, -1.0012055223233827, -1.0597818078703262e-05], [-0.2185482110100347, -0.001278352724001484, -0.8059927363418955], [0.9755113556897397, -0.0069062404665463884, -0.1828718970556851]], 'translation': [[-3.6161461463995823], [5.457329239070988], [1.20066790721975]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/015997.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/015997.json
load_json {'rotation': [[0.515468522897761, 0.8569083843530965, 0.0005944367634637966], [-0.8568861723229223, 0.5154506783334687, 0.007494273587029387], [0.006115538684741625, -0.0043724351254278825, 0.9999715943950417]], 'translation': [[3663.215855536866], [2323.929512019269], [20.298696443513315]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[-0.0018813691480436489, -1.001202227699611, 0.000960825428682549], [-0.2160776094434079, -0.0024443739472460287, -0.80645253852952], [0.9760613066228145, -0.0071593883047026095, -0.1808286238464312]], 'translation': [[-3.62205437666848], [5.386058205289697], [1.1705787874242386]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/002155.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/002155.json
load_json {'rotation': [[-0.8520863770248598, 0.5233980348160315, -0.001712779540578994], [-0.5233973956530888, -0.8520661348070948, 0.006221818784333795], [0.0017971176268460794, 0.006197981105951237, 0.9999787624783538]], 'translation': [[1485.0074270347832], [922.9789656437933], [21.895318873561024]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[0.2922167698792662, -0.9424315465326972, -0.07313658103781312], [-0.2135049938585527, 0.0170788893293273, -0.8301272369927399], [0.9328760834319906, 0.31188696097866253, -0.14981294771338136]], 'translation': [[-0.380393451247682], [5.490200842820187], [0.9427453931685306]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/007151.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/007151.json
load_json {'rotation': [[-0.8630731342760549, 0.5050698604432731, -0.00310466831341682], [-0.5050793228854381, -0.8630524790053478, 0.005974210731257009], [0.00033787316627834226, 0.006724270313167721, 0.9999769309923274]], 'translation': [[2733.2135308563593], [1694.9211892299354], [21.47488726983554]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[0.10111462826228429, -1.0006867544382827, 0.013239364089181454], [-0.21062291845761252, -0.03019167383008906, -0.7985936246389782], [0.9730683465666994, 0.08736982577529537, -0.17510904256726686]], 'translation': [[-2.4874205184861404], [5.5779696313776315], [1.3743794509284935]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/014252.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/014252.json
load_json {'rotation': [[0.47579786677327307, 0.8794713249288626, -0.012115539462621198], [-0.8795434940655147, 0.4756794928666776, -0.011475876082270908], [-0.004329585467991779, 0.016116355924175547, 0.99986069826929]], 'translation': [[520.1452522482723], [2354.5083030974492], [24.26932676663973]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[0.06214594130438941, -0.9938439704450884, 0.0063567940776371665], [-0.18840710892730142, -0.013558364372059574, -0.8202713981005046], [0.9802098373955253, 0.06420702987880988, -0.15785605914740944]], 'translation': [[-2.279273900231236], [5.456719113208662], [1.1284785483920567]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/019768.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/019768.json
load_json {'rotation': [[0.515468522897761, 0.8569083843530965, 0.0005944367634637966], [-0.8568861723229223, 0.5154506783334687, 0.007494273587029387], [0.006115538684741625, -0.0043724351254278825, 0.9999715943950417]], 'translation': [[3663.215855536866], [2323.929512019269], [20.298696443513315]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[-0.0018813691480436489, -1.001202227699611, 0.000960825428682549], [-0.2160776094434079, -0.0024443739472460287, -0.80645253852952], [0.9760613066228145, -0.0071593883047026095, -0.1808286238464312]], 'translation': [[-3.62205437666848], [5.386058205289697], [1.1705787874242386]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/016194.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/016194.json
load_json {'rotation': [[0.5154831044564933, 0.8568992812149886, 0.00031747724543475876], [-0.856855962581391, 0.5154530215766044, 0.01027377178861629], [0.008639952245136955, -0.005567987176849824, 0.9999476200547389]], 'translation': [[3663.217251131602], [2323.914483487606], [20.222843317727893]], 'relative_error': {'delta_x': 0.6600000000000001, 'delta_y': 0.5000000000000001}}
load_json {'rotation': [[-0.0018792800791834483, -1.0012055223233827, -1.0597818078703262e-05], [-0.2185482110100347, -0.001278352724001484, -0.8059927363418955], [0.9755113556897397, -0.0069062404665463884, -0.1828718970556851]], 'translation': [[-3.6161461463995823], [5.457329239070988], [1.20066790721975]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/010845.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/010845.json
load_json {'rotation': [[-0.9233081586619384, 0.38405880100487305, -0.0012513014082450357], [-0.38405391610835105, -0.9232674601556383, 0.008982890409796909], [0.0022951581163413014, 0.008774460055150451, 0.9999586592485981]], 'translation': [[4008.7757224749657], [2439.5460275355726], [20.493534368268314]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[-0.020229563736364618, -1.0040880047238776, -0.02380635677285588], [-0.17775768390745653, -0.007736191291208387, -0.8293122912533314], [0.9839467387880856, 0.0037327641938870344, -0.1492767963160718]], 'translation': [[-1.1115853629103765], [5.341750277960149], [0.6261344426685984]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/008559.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/008559.json
load_json {'rotation': [[-0.9233081586619384, 0.38405880100487305, -0.0012513014082450357], [-0.38405391610835105, -0.9232674601556383, 0.008982890409796909], [0.0022951581163413014, 0.008774460055150451, 0.9999586592485981]], 'translation': [[4008.7757224749657], [2439.5460275355726], [20.493534368268314]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[-0.020229563736364618, -1.0040880047238776, -0.02380635677285588], [-0.17775768390745653, -0.007736191291208387, -0.8293122912533314], [0.9839467387880856, 0.0037327641938870344, -0.1492767963160718]], 'translation': [[-1.1115853629103765], [5.341750277960149], [0.6261344426685984]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/017881.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/017881.json
load_json {'rotation': [[0.5154824907712857, 0.8568998902658318, -0.00030082354635701543], [-0.8568581449455395, 0.5154604616506343, 0.009728505388517071], [0.008491407451853429, -0.00475710996741688, 0.9999525418607722]], 'translation': [[3663.2204639926204], [2323.917435668409], [20.234707149920325]], 'relative_error': {'delta_x': -0.29999999999999993, 'delta_y': 0.6600000000000001}}
load_json {'rotation': [[-0.0018843613013384897, -1.0012030997336345, 0.0006585957812933042], [-0.2183985456635085, -0.002069393506238246, -0.8060203812537861], [0.9755451522771951, -0.007088108792289524, -0.1827468183059553]], 'translation': [[-3.6204006137027602], [5.445756989956435], [1.1971508559611757]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/014498.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/014498.json
load_json {'rotation': [[0.4758028577746022, 0.8794843418097013, -0.010929109059953257], [-0.8795324801741008, 0.4756746994548372, -0.012478539183214059], [-0.005775907592200931, 0.015549837888433327, 0.9998625302882364]], 'translation': [[520.1384141350281], [2354.513072744012], [24.31579060242036]], 'relative_error': {'delta_x': 0.6600000000000001, 'delta_y': -0.29999999999999993}}
load_json {'rotation': [[0.062142568539312264, -0.9938448386878966, 0.005966399718584578], [-0.18698340169247898, -0.013006335942795417, -0.8205073261502184], [0.9804826270857381, 0.06431076703104362, -0.15664124045352665]], 'translation': [[-2.2762258648127336], [5.412585006714611], [1.1118772667260848]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/016002.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/016002.json
load_json {'rotation': [[0.515468522897761, 0.8569083843530965, 0.0005944367634637966], [-0.8568861723229223, 0.5154506783334687, 0.007494273587029387], [0.006115538684741625, -0.0043724351254278825, 0.9999715943950417]], 'translation': [[3663.215855536866], [2323.929512019269], [20.298696443513315]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[-0.0018813691480436489, -1.001202227699611, 0.000960825428682549], [-0.2160776094434079, -0.0024443739472460287, -0.80645253852952], [0.9760613066228145, -0.0071593883047026095, -0.1808286238464312]], 'translation': [[-3.62205437666848], [5.386058205289697], [1.1705787874242386]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/012248.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/012248.json
load_json {'rotation': [[-0.9233013229213572, 0.3840752476704238, -0.00037411909991257763], [-0.38406074462927386, -0.9232568057684831, 0.009658845375236754], [0.0033636960844058658, 0.009061739344749709, 0.9999536428904147]], 'translation': [[4008.7713009363506], [2439.5422514667735], [20.456481452053946]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[-0.020239628823871172, -1.0040851219912115, -0.023572093699760665], [-0.17881674775535086, -0.00801310639348496, -0.8291586913964865], [0.983753937384875, 0.003664562656839346, -0.15016729915265134]], 'translation': [[-1.1133159802294141], [5.377565025363002], [0.6382787351014401]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/008429.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/008429.json
load_json {'rotation': [[-0.9233081586619384, 0.38405880100487305, -0.0012513014082450357], [-0.38405391610835105, -0.9232674601556383, 0.008982890409796909], [0.0022951581163413014, 0.008774460055150451, 0.9999586592485981]], 'translation': [[4008.7757224749657], [2439.5460275355726], [20.493534368268314]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[-0.020229563736364618, -1.0040880047238776, -0.02380635677285588], [-0.17775768390745653, -0.007736191291208387, -0.8293122912533314], [0.9839467387880856, 0.0037327641938870344, -0.1492767963160718]], 'translation': [[-1.1115853629103765], [5.341750277960149], [0.6261344426685984]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/012641.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/012641.json
load_json {'rotation': [[0.47579786677327307, 0.8794713249288626, -0.012115539462621198], [-0.8795434940655147, 0.4756794928666776, -0.011475876082270908], [-0.004329585467991779, 0.016116355924175547, 0.99986069826929]], 'translation': [[520.1452522482723], [2354.5083030974492], [24.26932676663973]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[0.06214594130438941, -0.9938439704450884, 0.0063567940776371665], [-0.18840710892730142, -0.013558364372059574, -0.8202713981005046], [0.9802098373955253, 0.06420702987880988, -0.15785605914740944]], 'translation': [[-2.279273900231236], [5.456719113208662], [1.1284785483920567]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/015992.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/015992.json
load_json {'rotation': [[0.515468522897761, 0.8569083843530965, 0.0005944367634637966], [-0.8568861723229223, 0.5154506783334687, 0.007494273587029387], [0.006115538684741625, -0.0043724351254278825, 0.9999715943950417]], 'translation': [[3663.215855536866], [2323.929512019269], [20.298696443513315]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[-0.0018813691480436489, -1.001202227699611, 0.000960825428682549], [-0.2160776094434079, -0.0024443739472460287, -0.80645253852952], [0.9760613066228145, -0.0071593883047026095, -0.1808286238464312]], 'translation': [[-3.62205437666848], [5.386058205289697], [1.1705787874242386]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/008648.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/008648.json
load_json {'rotation': [[-0.9232997426701146, 0.38408000853880514, -0.0005674470656514651], [-0.3840629016908527, -0.9232422348701288, 0.010931395567284116], [0.0036747465447355488, 0.010310961497249072, 0.9999404701199651]], 'translation': [[4008.7722907499992], [2439.535671555437], [20.44756908227028]], 'relative_error': {'delta_x': -0.29999999999999993, 'delta_y': -1.1}}
load_json {'rotation': [[-0.02024182029773183, -1.004075820165232, -0.022521701475784247], [-0.17915823931515462, -0.009245304167304678, -0.8291387020884182], [0.983692230804141, 0.003435587499364234, -0.15043873723863085]], 'translation': [[-1.1198992326354846], [5.387635257786342], [0.6418125473456242]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/012156.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/012156.json
load_json {'rotation': [[-0.9233013229213572, 0.3840752476704238, -0.00037411909991257763], [-0.38406074462927386, -0.9232568057684831, 0.009658845375236754], [0.0033636960844058658, 0.009061739344749709, 0.9999536428904147]], 'translation': [[4008.7713009363506], [2439.5422514667735], [20.456481452053946]], 'relative_error': {'delta_x': 0, 'delta_y': 0}}
load_json {'rotation': [[-0.020239628823871172, -1.0040851219912115, -0.023572093699760665], [-0.17881674775535086, -0.00801310639348496, -0.8291586913964865], [0.983753937384875, 0.003664562656839346, -0.15016729915265134]], 'translation': [[-1.1133159802294141], [5.377565025363002], [0.6382787351014401]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/018047.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/018047.json
load_json {'rotation': [[0.5154831044564933, 0.8568992812149886, 0.00031747724543475876], [-0.856855962581391, 0.5154530215766044, 0.01027377178861629], [0.008639952245136955, -0.005567987176849824, 0.9999476200547389]], 'translation': [[3663.217251131602], [2323.914483487606], [20.222843317727893]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[-0.0018792800791834483, -1.0012055223233827, -1.0597818078703262e-05], [-0.2185482110100347, -0.001278352724001484, -0.8059927363418955], [0.9755113556897397, -0.0069062404665463884, -0.1828718970556851]], 'translation': [[-3.6161461463995823], [5.457329239070988], [1.20066790721975]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/010458.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/010458.json
load_json {'rotation': [[-0.9233013229213572, 0.3840752476704238, -0.00037411909991257763], [-0.38406074462927386, -0.9232568057684831, 0.009658845375236754], [0.0033636960844058658, 0.009061739344749709, 0.9999536428904147]], 'translation': [[4008.7713009363506], [2439.5422514667735], [20.456481452053946]], 'relative_error': {'delta_x': 0.5400000000000001, 'delta_y': -1.1}}
load_json {'rotation': [[-0.020239628823871172, -1.0040851219912115, -0.023572093699760665], [-0.17881674775535086, -0.00801310639348496, -0.8291586913964865], [0.983753937384875, 0.003664562656839346, -0.15016729915265134]], 'translation': [[-1.1133159802294141], [5.377565025363002], [0.6382787351014401]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/006744.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/006744.json
load_json {'rotation': [[-0.8630731342760549, 0.5050698604432731, -0.00310466831341682], [-0.5050793228854381, -0.8630524790053478, 0.005974210731257009], [0.00033787316627834226, 0.006724270313167721, 0.9999769309923274]], 'translation': [[2733.2135308563593], [1694.9211892299354], [21.47488726983554]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[0.10111462826228429, -1.0006867544382827, 0.013239364089181454], [-0.21062291845761252, -0.03019167383008906, -0.7985936246389782], [0.9730683465666994, 0.08736982577529537, -0.17510904256726686]], 'translation': [[-2.4874205184861404], [5.5779696313776315], [1.3743794509284935]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/000039.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/000039.json
load_json {'rotation': [[0.854463098610578, -0.5195105091837793, 0.0012102751176149926], [0.5195000561482762, 0.8544244218454334, -0.0088276425335725], [0.0035518987605347592, 0.008171634487169012, 0.9999599188996214]], 'translation': [[3390.138583273976], [2087.3119082041085], [20.66834816604844]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[-0.0638033225610772, -0.9910914864003576, -0.04429948490729328], [-0.2102873406178483, 0.043997692433495696, -0.7987692871343754], [0.97575114561348, -0.06031492538699515, -0.17158543199893228]], 'translation': [[-5.779144404715124], [6.037615758600886], [1.0636424034755758]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/002968.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/002968.json
load_json {'rotation': [[-0.8520863770248598, 0.5233980348160315, -0.001712779540578994], [-0.5233973956530888, -0.8520661348070948, 0.006221818784333795], [0.0017971176268460794, 0.006197981105951237, 0.9999787624783538]], 'translation': [[1485.0074270347832], [922.9789656437933], [21.895318873561024]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[0.2922167698792662, -0.9424315465326972, -0.07313658103781312], [-0.2135049938585527, 0.0170788893293273, -0.8301272369927399], [0.9328760834319906, 0.31188696097866253, -0.14981294771338136]], 'translation': [[-0.380393451247682], [5.490200842820187], [0.9427453931685306]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/002512.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/002512.json
load_json {'rotation': [[-0.8520863770248598, 0.5233980348160315, -0.001712779540578994], [-0.5233973956530888, -0.8520661348070948, 0.006221818784333795], [0.0017971176268460794, 0.006197981105951237, 0.9999787624783538]], 'translation': [[1485.0074270347832], [922.9789656437933], [21.895318873561024]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[0.2922167698792662, -0.9424315465326972, -0.07313658103781312], [-0.2135049938585527, 0.0170788893293273, -0.8301272369927399], [0.9328760834319906, 0.31188696097866253, -0.14981294771338136]], 'translation': [[-0.380393451247682], [5.490200842820187], [0.9427453931685306]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/008943.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/008943.json
load_json {'rotation': [[-0.9233013229213572, 0.3840752476704238, -0.00037411909991257763], [-0.38406074462927386, -0.9232568057684831, 0.009658845375236754], [0.0033636960844058658, 0.009061739344749709, 0.9999536428904147]], 'translation': [[4008.7713009363506], [2439.5422514667735], [20.456481452053946]], 'relative_error': {'delta_x': -0.9400000000000001, 'delta_y': -1.02}}
load_json {'rotation': [[-0.020239628823871172, -1.0040851219912115, -0.023572093699760665], [-0.17881674775535086, -0.00801310639348496, -0.8291586913964865], [0.983753937384875, 0.003664562656839346, -0.15016729915265134]], 'translation': [[-1.1133159802294141], [5.377565025363002], [0.6382787351014401]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/018220.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/018220.json
load_json {'rotation': [[0.515468522897761, 0.8569083843530965, 0.0005944367634637966], [-0.8568861723229223, 0.5154506783334687, 0.007494273587029387], [0.006115538684741625, -0.0043724351254278825, 0.9999715943950417]], 'translation': [[3663.215855536866], [2323.929512019269], [20.298696443513315]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[-0.0018813691480436489, -1.001202227699611, 0.000960825428682549], [-0.2160776094434079, -0.0024443739472460287, -0.80645253852952], [0.9760613066228145, -0.0071593883047026095, -0.1808286238464312]], 'translation': [[-3.62205437666848], [5.386058205289697], [1.1705787874242386]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/000089.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/000089.json
load_json {'rotation': [[0.8544626937357239, -0.5195108047568648, 0.0014712647642387891], [0.5195014032015495, 0.8544217077116085, -0.009057846071333678], [0.003448519629307465, 0.008503915123655812, 0.9999581025029773]], 'translation': [[3390.137172839197], [2087.3130645751953], [20.679657624445603]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[-0.0637997719236052, -0.9911021038671801, -0.04403454403590408], [-0.21018452259976808, 0.04367514757246314, -0.7988054387499416], [0.9757735226022318, -0.060384750305952924, -0.17148761423359657]], 'translation': [[-5.781412278964476], [6.0267551534220924], [1.0605440051682082]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/002559.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/002559.json
load_json {'rotation': [[-0.8520863770248598, 0.5233980348160315, -0.001712779540578994], [-0.5233973956530888, -0.8520661348070948, 0.006221818784333795], [0.0017971176268460794, 0.006197981105951237, 0.9999787624783538]], 'translation': [[1485.0074270347832], [922.9789656437933], [21.895318873561024]], 'relative_error': {'delta_x': '', 'delta_y': ''}}
load_json {'rotation': [[0.2922167698792662, -0.9424315465326972, -0.07313658103781312], [-0.2135049938585527, 0.0170788893293273, -0.8301272369927399], [0.9328760834319906, 0.31188696097866253, -0.14981294771338136]], 'translation': [[-0.380393451247682], [5.490200842820187], [0.9427453931685306]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/015613.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/015613.json
load_json {'rotation': [[0.5154831044564933, 0.8568992812149886, 0.00031747724543475876], [-0.856855962581391, 0.5154530215766044, 0.01027377178861629], [0.008639952245136955, -0.005567987176849824, 0.9999476200547389]], 'translation': [[3663.217251131602], [2323.914483487606], [20.222843317727893]], 'relative_error': {'delta_x': -1.02, 'delta_y': 0.6600000000000001}}
load_json {'rotation': [[-0.0018792800791834483, -1.0012055223233827, -1.0597818078703262e-05], [-0.2185482110100347, -0.001278352724001484, -0.8059927363418955], [0.9755113556897397, -0.0069062404665463884, -0.1828718970556851]], 'translation': [[-3.6161461463995823], [5.457329239070988], [1.20066790721975]]}
./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/005010.bin
osp.join(cilib_path) ./data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/calib/virtuallidar_to_world/005010.json
load_json {'rotation': [[-0.8630731342760549, 0.5050698604432731, -0.00310466831341682], [-0.5050793228854381, -0.8630524790053478, 0.005974210731257009], [0.00033787316627834226, 0.006724270313167721, 0.9999769309923274]], 'translation': [[2733.2135308563593], [1694.9211892299354], [21.47488726983554]], 'relative_error': {'delta_x': 0.2600000000000001, 'delta_y': -0.25999999999999995}}
load_json {'rotation': [[0.10111462826228429, -1.0006867544382827, 0.013239364089181454], [-0.21062291845761252, -0.03019167383008906, -0.7985936246389782], [0.9730683465666994, 0.08736982577529537, -0.17510904256726686]], 'translation': [[-2.4874205184861404], [5.5779696313776315], [1.3743794509284935]]}
into bev
kwargs {}
torch.Size([2, 1, 3, 256, 704])
torch.Size([26595, 4])
torch.Size([2, 1, 4, 4])
torch.Size([2, 1, 4, 4])
torch.Size([2, 1, 4, 4])
torch.Size([2, 1, 4, 4])
torch.Size([2, 1, 4, 4])
torch.Size([2, 1, 4, 4])
torch.Size([2, 1, 4, 4])
torch.Size([2, 4, 4])
[{'filename': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/image_2/002155.jpg', 'ori_shape': (1920, 1080), 'img_shape': (1920, 1080), 'lidar2image': [array([[ 1.5562427e+03, -1.7565118e+03, -3.0729111e+02,  9.3616516e+01],
       [-2.9841919e+00,  2.0547301e+02, -2.0171212e+03,  1.3315082e+04],
       [ 9.3287611e-01,  3.1188697e-01, -1.4981295e-01,  9.4274539e-01],
       [ 0.0000000e+00,  0.0000000e+00,  0.0000000e+00,  1.0000000e+00]],
      dtype=float32)], 'box_mode_3d': <Box3DMode.LIDAR: 0>, 'box_type_3d': <class 'mmdet3d.core.bbox.structures.lidar_box3d.LiDARInstance3DBoxes'>, 'img_norm_cfg': {'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}}, {'filename': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/image_2/007151.jpg', 'ori_shape': (1920, 1080), 'img_shape': (1920, 1080), 'lidar2image': [array([[ 1.1611228e+03, -2.0796943e+03, -1.4096091e+02, -4.0487583e+03],
       [ 5.7750427e+01, -2.0843143e+01, -1.9405499e+03,  1.3638778e+04],
       [ 9.7306836e-01,  8.7369829e-02, -1.7510904e-01,  1.3743794e+00],
       [ 0.0000000e+00,  0.0000000e+00,  0.0000000e+00,  1.0000000e+00]],
      dtype=float32)], 'box_mode_3d': <Box3DMode.LIDAR: 0>, 'box_type_3d': <class 'mmdet3d.core.bbox.structures.lidar_box3d.LiDARInstance3DBoxes'>, 'img_norm_cfg': {'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}}]
batch_size
end
forward_single
sensor camera
BaseDepthTransform datainfo
torch.Size([2, 1, 256, 32, 88])
torch.Size([26595, 4])
torch.Size([2, 1, 4, 4])
torch.Size([2, 1, 4, 4])
torch.Size([2, 1, 4, 4])
torch.Size([2, 1, 4, 4])
torch.Size([2, 1, 4, 4])
torch.Size([2, 1, 4, 4])
torch.Size([2, 1, 4, 4])
torch.Size([2, 4, 4])
[{'filename': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/image_2/002155.jpg', 'ori_shape': (1920, 1080), 'img_shape': (1920, 1080), 'lidar2image': [array([[ 1.5562427e+03, -1.7565118e+03, -3.0729111e+02,  9.3616516e+01],
       [-2.9841919e+00,  2.0547301e+02, -2.0171212e+03,  1.3315082e+04],
       [ 9.3287611e-01,  3.1188697e-01, -1.4981295e-01,  9.4274539e-01],
       [ 0.0000000e+00,  0.0000000e+00,  0.0000000e+00,  1.0000000e+00]],
      dtype=float32)], 'box_mode_3d': <Box3DMode.LIDAR: 0>, 'box_type_3d': <class 'mmdet3d.core.bbox.structures.lidar_box3d.LiDARInstance3DBoxes'>, 'img_norm_cfg': {'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}}, {'filename': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/image_2/007151.jpg', 'ori_shape': (1920, 1080), 'img_shape': (1920, 1080), 'lidar2image': [array([[ 1.1611228e+03, -2.0796943e+03, -1.4096091e+02, -4.0487583e+03],
       [ 5.7750427e+01, -2.0843143e+01, -1.9405499e+03,  1.3638778e+04],
       [ 9.7306836e-01,  8.7369829e-02, -1.7510904e-01,  1.3743794e+00],
       [ 0.0000000e+00,  0.0000000e+00,  0.0000000e+00,  1.0000000e+00]],
      dtype=float32)], 'box_mode_3d': <Box3DMode.LIDAR: 0>, 'box_type_3d': <class 'mmdet3d.core.bbox.structures.lidar_box3d.LiDARInstance3DBoxes'>, 'img_norm_cfg': {'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}}]
batch_size 2
sensor lidar
extract_lidar_features
extract_lidar_features torch.Size([38457, 4]) torch.Size([38457, 4]) torch.Size([38457]) tensor(2, device='cuda:0', dtype=torch.int32)
into SparseEncoder1
input_sp_tensor <mmdet3d.ops.spconv.structure.SparseConvTensor object at 0x7f2fc02858b0>
type <class 'mmdet3d.ops.spconv.structure.SparseConvTensor'>
into SparseEncoder2
